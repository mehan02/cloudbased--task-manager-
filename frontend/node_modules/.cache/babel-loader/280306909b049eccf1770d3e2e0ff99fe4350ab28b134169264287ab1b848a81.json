{"ast":null,"code":"import axios from\"axios\";const API_URL=process.env.REACT_APP_API_URL||\"http://localhost:8080/api\";const api=axios.create({baseURL:API_URL,timeout:10000// 10 second timeout\n});// Intercept request to add JWT token\napi.interceptors.request.use(config=>{const token=localStorage.getItem(\"token\");if(token){// Check if token is expired before making request\ntry{const payload=JSON.parse(atob(token.split('.')[1]));const currentTime=Date.now()/1000;const timeUntilExpiry=payload.exp-currentTime;console.log('Token check - exp:',payload.exp,'current:',currentTime,'valid:',payload.exp>currentTime,'timeUntilExpiry:',timeUntilExpiry);// If token expires in less than 1 hour, show a gentle reminder\nif(timeUntilExpiry<3600&&timeUntilExpiry>0){console.log('Token will expire soon, showing reminder');const notification=document.createElement('div');notification.style.cssText=\"\\n          position: fixed;\\n          top: 20px;\\n          right: 20px;\\n          background: linear-gradient(to right, #f59e0b, #d97706);\\n          color: white;\\n          padding: 16px 24px;\\n          border-radius: 12px;\\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\\n          z-index: 999999;\\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\\n          font-weight: 500;\\n          max-width: 300px;\\n          animation: slideIn 0.3s ease-out;\\n        \";notification.innerHTML=\"\\n          <div style=\\\"display: flex; align-items: center; gap: 12px;\\\">\\n            <svg width=\\\"20\\\" height=\\\"20\\\" fill=\\\"currentColor\\\" viewBox=\\\"0 0 20 20\\\">\\n              <path fill-rule=\\\"evenodd\\\" d=\\\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\\\" clip-rule=\\\"evenodd\\\" />\\n            </svg>\\n            <span>Session will expire soon. Please save your work.</span>\\n          </div>\\n        \";document.body.appendChild(notification);// Remove notification after 5 seconds\nsetTimeout(()=>{if(notification.parentNode){notification.parentNode.removeChild(notification);}},5000);}if(payload.exp<currentTime){console.log('Token expired, clearing and redirecting to login');localStorage.removeItem('token');localStorage.removeItem('user');if(window.location.pathname!=='/login'){// Don't show alert here, let the response interceptor handle it\nwindow.location.href='/login';}return Promise.reject(new Error('Token expired'));}}catch(error){console.log('Invalid token format, clearing and redirecting to login');localStorage.removeItem('token');localStorage.removeItem('user');if(window.location.pathname!=='/login'){// Don't show alert here, let the response interceptor handle it\nwindow.location.href='/login';}return Promise.reject(new Error('Invalid token'));}config.headers.Authorization=\"Bearer \".concat(token);}return config;});// Intercept responses to handle errors\napi.interceptors.response.use(response=>response,error=>{if(error.code==='ECONNABORTED'){console.error('Request timeout - server might be down');}// If we get a 401 or 403 error, clear the invalid token\nif(error.response&&(error.response.status===401||error.response.status===403)){console.log('Authentication error detected, clearing token and redirecting to login');localStorage.removeItem('token');localStorage.removeItem('user');// Show a more user-friendly message before redirecting\nif(window.location.pathname!=='/login'){// Use a more subtle notification instead of alert\nconst notification=document.createElement('div');notification.style.cssText=\"\\n          position: fixed;\\n          top: 20px;\\n          right: 20px;\\n          background: linear-gradient(to right, #ef4444, #dc2626);\\n          color: white;\\n          padding: 16px 24px;\\n          border-radius: 12px;\\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\\n          z-index: 999999;\\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\\n          font-weight: 500;\\n          max-width: 300px;\\n          animation: slideIn 0.3s ease-out;\\n        \";notification.innerHTML=\"\\n          <div style=\\\"display: flex; align-items: center; gap: 12px;\\\">\\n            <svg width=\\\"20\\\" height=\\\"20\\\" fill=\\\"currentColor\\\" viewBox=\\\"0 0 20 20\\\">\\n              <path fill-rule=\\\"evenodd\\\" d=\\\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\\\" clip-rule=\\\"evenodd\\\" />\\n            </svg>\\n            <span>Session expired. Redirecting to login...</span>\\n          </div>\\n        \";document.body.appendChild(notification);// Remove notification after 3 seconds\nsetTimeout(()=>{if(notification.parentNode){notification.parentNode.removeChild(notification);}},3000);// Redirect after a short delay\nsetTimeout(()=>{window.location.href='/login';},1000);}}return Promise.reject(error);});// Helper functions for common API calls\nexport const authAPI={login:credentials=>api.post(\"/auth/login\",credentials),signup:userData=>api.post(\"/auth/signup\",userData),register:userData=>api.post(\"/auth/register\",userData)};export const tasksAPI={getAll:()=>api.get(\"/tasks\"),getToday:()=>api.get(\"/tasks/today\"),getUpcoming:()=>api.get(\"/tasks/upcoming\"),getByList:listId=>api.get(\"/tasks/list/\".concat(listId)),create:task=>api.post(\"/tasks\",task),update:(id,task)=>api.put(\"/tasks/\".concat(id),task),delete:id=>api.delete(\"/tasks/\".concat(id)),reorder:taskOrders=>api.put(\"/tasks/reorder\",taskOrders)};export const listsAPI={getAll:()=>api.get(\"/lists\"),getTasks:listId=>api.get(\"/lists/\".concat(listId,\"/tasks\")),create:list=>api.post(\"/lists\",list),update:(id,list)=>api.put(\"/lists/\".concat(id),list),delete:id=>api.delete(\"/lists/\".concat(id))};export default api;","map":{"version":3,"names":["axios","API_URL","process","env","REACT_APP_API_URL","api","create","baseURL","timeout","interceptors","request","use","config","token","localStorage","getItem","payload","JSON","parse","atob","split","currentTime","Date","now","timeUntilExpiry","exp","console","log","notification","document","createElement","style","cssText","innerHTML","body","appendChild","setTimeout","parentNode","removeChild","removeItem","window","location","pathname","href","Promise","reject","Error","error","headers","Authorization","concat","response","code","status","authAPI","login","credentials","post","signup","userData","register","tasksAPI","getAll","get","getToday","getUpcoming","getByList","listId","task","update","id","put","delete","reorder","taskOrders","listsAPI","getTasks","list"],"sources":["/Users/mehan/Documents/task-manager-frontend/frontend/src/services/api.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_URL = process.env.REACT_APP_API_URL || \"http://localhost:8080/api\";\n\nconst api = axios.create({\n  baseURL: API_URL,\n  timeout: 10000, // 10 second timeout\n});\n\n// Intercept request to add JWT token\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    // Check if token is expired before making request\n    try {\n      const payload = JSON.parse(atob(token.split('.')[1]));\n      const currentTime = Date.now() / 1000;\n      const timeUntilExpiry = payload.exp - currentTime;\n      console.log('Token check - exp:', payload.exp, 'current:', currentTime, 'valid:', payload.exp > currentTime, 'timeUntilExpiry:', timeUntilExpiry);\n      \n      // If token expires in less than 1 hour, show a gentle reminder\n      if (timeUntilExpiry < 3600 && timeUntilExpiry > 0) {\n        console.log('Token will expire soon, showing reminder');\n        const notification = document.createElement('div');\n        notification.style.cssText = `\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          background: linear-gradient(to right, #f59e0b, #d97706);\n          color: white;\n          padding: 16px 24px;\n          border-radius: 12px;\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\n          z-index: 999999;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n          font-weight: 500;\n          max-width: 300px;\n          animation: slideIn 0.3s ease-out;\n        `;\n        notification.innerHTML = `\n          <div style=\"display: flex; align-items: center; gap: 12px;\">\n            <svg width=\"20\" height=\"20\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fill-rule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clip-rule=\"evenodd\" />\n            </svg>\n            <span>Session will expire soon. Please save your work.</span>\n          </div>\n        `;\n        document.body.appendChild(notification);\n        \n        // Remove notification after 5 seconds\n        setTimeout(() => {\n          if (notification.parentNode) {\n            notification.parentNode.removeChild(notification);\n          }\n        }, 5000);\n      }\n      \n      if (payload.exp < currentTime) {\n        console.log('Token expired, clearing and redirecting to login');\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        if (window.location.pathname !== '/login') {\n          // Don't show alert here, let the response interceptor handle it\n          window.location.href = '/login';\n        }\n        return Promise.reject(new Error('Token expired'));\n      }\n    } catch (error) {\n      console.log('Invalid token format, clearing and redirecting to login');\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      if (window.location.pathname !== '/login') {\n        // Don't show alert here, let the response interceptor handle it\n        window.location.href = '/login';\n      }\n      return Promise.reject(new Error('Invalid token'));\n    }\n    \n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// Intercept responses to handle errors\napi.interceptors.response.use(\n  response => response,\n  error => {\n    if (error.code === 'ECONNABORTED') {\n      console.error('Request timeout - server might be down');\n    }\n    // If we get a 401 or 403 error, clear the invalid token\n    if (error.response && (error.response.status === 401 || error.response.status === 403)) {\n      console.log('Authentication error detected, clearing token and redirecting to login');\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      \n      // Show a more user-friendly message before redirecting\n      if (window.location.pathname !== '/login') {\n        // Use a more subtle notification instead of alert\n        const notification = document.createElement('div');\n        notification.style.cssText = `\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          background: linear-gradient(to right, #ef4444, #dc2626);\n          color: white;\n          padding: 16px 24px;\n          border-radius: 12px;\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\n          z-index: 999999;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n          font-weight: 500;\n          max-width: 300px;\n          animation: slideIn 0.3s ease-out;\n        `;\n        notification.innerHTML = `\n          <div style=\"display: flex; align-items: center; gap: 12px;\">\n            <svg width=\"20\" height=\"20\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clip-rule=\"evenodd\" />\n            </svg>\n            <span>Session expired. Redirecting to login...</span>\n          </div>\n        `;\n        document.body.appendChild(notification);\n        \n        // Remove notification after 3 seconds\n        setTimeout(() => {\n          if (notification.parentNode) {\n            notification.parentNode.removeChild(notification);\n          }\n        }, 3000);\n        \n        // Redirect after a short delay\n        setTimeout(() => {\n          window.location.href = '/login';\n        }, 1000);\n      }\n    }\n    return Promise.reject(error);\n  }\n);\n\n// Helper functions for common API calls\nexport const authAPI = {\n  login: (credentials) => api.post(\"/auth/login\", credentials),\n  signup: (userData) => api.post(\"/auth/signup\", userData),\n  register: (userData) => api.post(\"/auth/register\", userData)\n};\n\nexport const tasksAPI = {\n  getAll: () => api.get(\"/tasks\"),\n  getToday: () => api.get(\"/tasks/today\"),\n  getUpcoming: () => api.get(\"/tasks/upcoming\"),\n  getByList: (listId) => api.get(`/tasks/list/${listId}`),\n  create: (task) => api.post(\"/tasks\", task),\n  update: (id, task) => api.put(`/tasks/${id}`, task),\n  delete: (id) => api.delete(`/tasks/${id}`),\n  reorder: (taskOrders) => api.put(\"/tasks/reorder\", taskOrders),\n};\n\nexport const listsAPI = {\n  getAll: () => api.get(\"/lists\"),\n  getTasks: (listId) => api.get(`/lists/${listId}/tasks`),\n  create: (list) => api.post(\"/lists\", list),\n  update: (id, list) => api.put(`/lists/${id}`, list),\n  delete: (id) => api.delete(`/lists/${id}`)\n};\n\nexport default api;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}